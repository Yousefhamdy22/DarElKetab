<div class="bg-gradient-to-b from-gray-50 to-white min-h-screen p-4 md:p-6" dir="rtl">
    <div class="max-w-7xl mx-auto">
      <!-- Header with Back Button -->
      <div class="flex justify-between items-center mb-6">
        <button pButton icon="pi pi-arrow-right" label="العودة إلى قائمة الطلاب" 
               routerLink="/students" class="p-button-text text-emerald-600 hover:bg-emerald-50"></button>
        <div class="flex gap-2">
          <button pButton icon="pi pi-print" label="طباعة التقرير"
                  class="p-button-outlined p-button-sm text-gray-600"></button>
          <button pButton icon="pi pi-download" label="تصدير PDF"
                  class="p-button-outlined p-button-sm text-blue-600"></button>
        </div>
      </div>
      <!-- <div *ngIf="loading" class="text-center py-8">
        <p-progressSpinner></p-progressSpinner>
        <p class="mt-2 text-gray-600">جاري تحميل بيانات الطالب...</p>
      </div> -->
      
     
      <!-- Student Profile Header -->
      <div class="bg-white rounded-xl shadow-sm border border-gray-200 mb-6 overflow-hidden">
        <div class="bg-gradient-to-r from-emerald-600 to-teal-500 h-32 relative">
          <div class="absolute bottom-4 left-6 flex items-end gap-4">
            <div class="text-white">
              <h1 class="text-2xl md:text-3xl font-bold">{{ student?.name }}</h1>
              <div class="flex items-center gap-2 mt-1 flex-wrap">
                <span class="bg-white bg-opacity-20 text-white text-xs px-2 py-1 rounded-full">
                  ID: {{ student?.studentID }}
                </span>
                <p-tag [value]="student?.isActive ? 'نشط' : 'غير نشط'" 
                      [severity]="student?.isActive ? 'success' : 'danger'"
                      [rounded]="true" class="opacity-90"></p-tag>
              </div>
            </div>
          </div>
        </div>
        <div class="p-6">
          <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div class="flex items-center gap-3">
              <i class="pi pi-calendar text-gray-400"></i>
              <div>
                <p class="text-xs text-gray-500">تاريخ التسجيل</p>
                <p class="text-sm font-medium">{{ student?.registrationDate | date:'dd/MM/yyyy' }}</p>
              </div>
            </div>
            <div class="flex items-center gap-3">
              <i class="pi pi-clock text-gray-400"></i>
              <div>
                <p class="text-xs text-gray-500">آخر نشاط</p>
                <p class="text-sm font-medium">{{ student?.isActive }}</p>
              </div>
            </div>
            <div class="flex items-center gap-3">
              <i class="pi pi-users text-gray-400"></i>
              <div>
                <p class="text-xs text-gray-500">المجموعة</p>
                <p class="text-sm font-medium">{{ student?.groupID || 'غير محدد' }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>
  
      <!-- Main Content Grid -->
      <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
        <!-- Left Column - Student Information -->
        <div class="lg:col-span-1 space-y-6">
          <!-- Basic Information Card -->
          <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2">
              <i class="pi pi-user text-emerald-600"></i>
              المعلومات الأساسية
            </h3>
            
            <div class="space-y-4">
              <div>
                <label class="text-xs text-gray-500 block mb-1">رقم الهاتف</label>
                <p class="font-medium">{{ student?.phoneNumber || 'غير متوفر' }}</p>
              </div>
              
              <div>
                <label class="text-xs text-gray-500 block mb-1">تاريخ الميلاد</label>
                <p class="font-medium">{{ student?.birthDate | date:'dd/MM/yyyy' }}</p>
                <p class="text-xs text-gray-500">العمر: {{ calculateAge(student?.birthDate?.toString() || '') }} سنة</p>
              </div>
              
              <div>
                <label class="text-xs text-gray-500 block mb-1">العنوان</label>
                <p class="font-medium">{{ student?.name || 'غير متوفر' }}</p>
              </div>
            </div>
          </div>
  
          <!-- Parent Information Card -->
          
        </div>
  
        <!-- Right Column - Reports -->
        <div class="lg:col-span-3 space-y-6">
          <!-- Attendance Report Section -->
          <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
              <h3 class="text-xl font-semibold text-gray-800 flex items-center gap-2">
                <i class="pi pi-calendar text-blue-600"></i>
                تقرير الحضور
              </h3>
              
              <div class="flex items-center gap-3">
                <p-dropdown [options]="monthOptions" [(ngModel)]="selectedMonth" 
                           optionLabel="name" placeholder="اختر الشهر"
                           class="w-40"></p-dropdown>
              </div>
            </div>
  
            <!-- Attendance Stats -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
              <div class="bg-blue-50 rounded-lg p-4 border border-blue-100">
                <div class="flex items-center justify-between">
                  <div>
                    <p class="text-sm text-blue-600">نسبة الحضور</p>
                    <h3 class="text-2xl font-bold text-blue-800">{{ attendanceStats.percentage }}%</h3>
                  </div>
                  <i class="pi pi-chart-line text-2xl text-blue-400"></i>
                </div>
              </div>
              
              <div class="bg-emerald-50 rounded-lg p-4 border border-emerald-100">
                <div class="flex items-center justify-between">
                  <div>
                    <p class="text-sm text-emerald-600">أيام الحضور</p>
                    <h3 class="text-2xl font-bold text-emerald-800">{{ attendanceStats.present }}</h3>
                  </div>
                  <i class="pi pi-check-circle text-2xl text-emerald-400"></i>
                </div>
              </div>
              
              <div class="bg-amber-50 rounded-lg p-4 border border-amber-100">
                <div class="flex items-center justify-between">
                  <div>
                    <p class="text-sm text-amber-600">أيام الغياب</p>
                    <h3 class="text-2xl font-bold text-amber-800">{{ attendanceStats.absent }}</h3>
                  </div>
                  <i class="pi pi-times-circle text-2xl text-amber-400"></i>
                </div>
              </div>
            </div>
  
            <!-- Attendance Calendar -->
            <div class="mb-6">
              <h4 class="text-md font-medium text-gray-700 mb-3">سجل الحضور اليومي</h4>
              <div class="grid grid-cols-7 gap-2">
                <div *ngFor="let day of daysOfWeek" class="text-center text-xs text-gray-500 py-1">
                  {{ day }}
                </div>
                <ng-container *ngFor="let day of attendanceCalendar">
                  <div *ngIf="day.date" class="h-12 rounded-lg flex flex-col items-center justify-center cursor-pointer text-sm"
                       [ngClass]="{
                         'bg-emerald-100 text-emerald-800': day.status === 'present',
                         'bg-red-100 text-red-800': day.status === 'absent',
                         'bg-amber-100 text-amber-800': day.status === 'excused',
                         'bg-gray-100 text-gray-400': !day.status
                       }">
                    <span>{{ day.date.getDate() }}</span>
                  </div>
                  <div *ngIf="!day.date" class="h-12"></div>
                </ng-container>
              </div>
            </div>
  
            <!-- Attendance Details -->
            <div>
              <div class="flex justify-between items-center mb-3">
                <h4 class="text-md font-medium text-gray-700">تفاصيل الحضور</h4>
                <button pButton icon="pi pi-search" label="بحث" 
                        class="p-button-text p-button-sm text-gray-600"></button>
              </div>
              
              <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                  <thead class="bg-gray-50">
                    <tr>
                      <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase">التاريخ</th>
                      <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase">الحالة</th>
                      <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase">الوقت</th>
                      <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase">ملاحظات</th>
                    </tr>
                  </thead>
                  <tbody class="bg-white divide-y divide-gray-200">
                    <tr *ngFor="let record of attendanceRecords" class="hover:bg-gray-50">
                      <td class="px-4 py-3 whitespace-nowrap text-sm">{{ record.date | date:'dd/MM/yyyy' }}</td>
                      <td class="px-4 py-3 whitespace-nowrap">
                        <p-tag [value]="getStatusText(record.status)" 
                              [severity]="getStatusSeverity(record.status)"></p-tag>
                      </td>
                      <td class="px-4 py-3 whitespace-nowrap text-sm">{{ record.time || '--' }}</td>
                      <td class="px-4 py-3 text-sm text-gray-500">{{ record.notes || '--' }}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
  
          <!-- Academic Performance Section -->
          <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
              <h3 class="text-xl font-semibold text-gray-800 flex items-center gap-2">
                <i class="pi pi-book text-purple-600"></i>
                التقرير الأكاديمي
              </h3>
              
              <div class="flex items-center gap-3">
                <p-dropdown [options]="termOptions" [(ngModel)]="selectedTerm" 
                           optionLabel="name" placeholder="اختر الفصل"
                           class="w-40"></p-dropdown>
              </div>
            </div>
  
            <!-- Performance Overview -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
              <div class="bg-purple-50 rounded-lg p-4 border border-purple-100">
                <div class="flex items-center justify-between">
                  <div>
                    <p class="text-sm text-purple-600">المعدل العام</p>
                    <h3 class="text-2xl font-bold text-purple-800">{{ academicStats.average }}%</h3>
                  </div>
                  <i class="pi pi-chart-bar text-2xl text-purple-400"></i>
                </div>
              </div>
              
              <div class="bg-indigo-50 rounded-lg p-4 border border-indigo-100">
                <div class="flex items-center justify-between">
                  <div>
                    <p class="text-sm text-indigo-600">أعلى درجة</p>
                    <h3 class="text-2xl font-bold text-indigo-800">{{ academicStats.highest }}%</h3>
                    <p class="text-xs text-gray-500 mt-1">{{ academicStats.highestSubject }}</p>
                  </div>
                  <i class="pi pi-arrow-up text-2xl text-indigo-400"></i>
                </div>
              </div>
              
              <div class="bg-teal-50 rounded-lg p-4 border border-teal-100">
                <div class="flex items-center justify-between">
                  <div>
                    <p class="text-sm text-teal-600">عدد الاختبارات</p>
                    <h3 class="text-2xl font-bold text-teal-800">{{ academicStats.totalExams }}</h3>
                  </div>
                  <i class="pi pi-file-edit text-2xl text-teal-400"></i>
                </div>
              </div>
            </div>
  
            <!-- Performance Chart -->
            <div class="h-64 mb-6">
              <p-chart type="line" [data]="performanceChartData" [options]="chartOptions"></p-chart>
            </div>
  
            <!-- Exams Results -->
            <div>
              <h4 class="text-md font-medium text-gray-700 mb-3">نتائج الاختبارات</h4>
              
              <div class="space-y-3">
                <div *ngFor="let exam of exams" class="border-l-4 border-purple-500 pl-4 py-2">
                  <div class="flex justify-between items-start">
                    <div>
                      <p class="font-medium">{{ exam.subject }}</p>
                      <p class="text-sm text-gray-500">{{ exam.type }} - {{ exam.date | date:'dd/MM/yyyy' }}</p>
                    </div>
                    <div class="flex items-center gap-2">
                      <span class="text-lg font-bold" 
                            [ngClass]="{
                              'text-emerald-600': exam.grade >= 90,
                              'text-blue-600': exam.grade >= 80,
                              'text-amber-600': exam.grade >= 70,
                              'text-red-600': exam.grade < 70
                            }">
                        {{ exam.grade }}%
                      </span>
                      <p-tag [value]="getGradeText(exam.grade)" 
                            [severity]="getGradeSeverity(exam.grade)"></p-tag>
                    </div>
                  </div>
                  <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
                    <div class="h-2 rounded-full" 
                         [ngClass]="{
                           'bg-emerald-500': exam.grade >= 90,
                           'bg-blue-500': exam.grade >= 80,
                           'bg-amber-500': exam.grade >= 70,
                           'bg-red-500': exam.grade < 70
                         }"
                         [style.width]="exam.grade + '%'"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
  
          <!-- Notes Section -->
          <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-xl font-semibold text-gray-800 flex items-center gap-2">
                <i class="pi pi-comments text-amber-600"></i>
                الملاحظات
              </h3>
              <button pButton icon="pi pi-plus" label="إضافة ملاحظة" 
                      class="p-button-text p-button-sm text-emerald-600"></button>
            </div>
            
            <div class="space-y-4">
              <div *ngFor="let note of notes" class="bg-gray-50 p-4 rounded-lg">
                <div class="flex justify-between items-start">
                  <p class="font-medium">{{ note.title }}</p>
                  <span class="text-xs text-gray-500">{{ note.date | date:'dd/MM/yyyy' }}</span>
                </div>
                <p class="text-sm text-gray-600 mt-2">{{ note.content }}</p>
                <!-- <div class="flex items-center gap-2 mt-3">
                  <img [src]="note.teacherAvatar || 'assets/default-avatar.png'" class="w-6 h-6 rounded-full">
                  <span class="text-xs text-gray-500">{{ note.teacherName }}</span>
                </div> -->
              </div>
              
              <div *ngIf="notes.length === 0" class="text-center py-8 border border-dashed border-gray-300 rounded-lg">
                <i class="pi pi-inbox text-3xl text-gray-400 mb-2"></i>
                <p class="text-gray-500">لا توجد ملاحظات مسجلة</p>
              </div>
            </div>
          </div>




        </div>
      </div>
    </div>
  </div>